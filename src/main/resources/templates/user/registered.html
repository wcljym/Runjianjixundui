<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" data-th-fragment="header">
<!--<head th:replace="~{fragments/header :: header}">-->
<head>
    <meta charset="UTF-8">
    <title>注册</title>

    <link rel="stylesheet" th:href="@{../registered/css/reset.css}" href="../registered/css/reset.css">
    <link rel="stylesheet" th:href="@{../registered/css/common.css}" href="../registered/css/common.css">
    <link rel="stylesheet" th:href="@{../registered/css/font-awesome.min.css}"
          href="../registered/css/font-awesome.min.css">

    <!--<link rel="stylesheet" th:href="@{../layui/css/layui.css}" href="../layui/css/layui.css">-->
    <!--<style type="text/css">-->
    <!--.starter-template {-->
    <!--position: relative;-->
    <!--width:auto;/**宽度**/-->
    <!--height:auto;/**高度**/-->
    <!--position:absolute;/**绝对定位**/-->
    <!--left:50%;/**左边50%**/-->
    <!--top:30%;/**顶部50%**/-->
    <!--margin-bottom: 50%;-->
    <!--margin-top:-50px;/**上移-50%**/-->
    <!--margin-left:-100px;/**左移-50%**/-->

    <!--}-->
    <!--</style>-->
</head>
<body>

<!--<div class="starter-template ">-->

<!--<form class="layui-form" th:action="@{/registered1}" method="post">-->
<!--<div class="layui-form-item ">-->
<!--&lt;!&ndash;<label class="layui-form-label">用户名</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="text" id="username" name="username" required lay-verify="required" placeholder="请输入用户名"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->
<!--&lt;!&ndash; 对号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="ri" style="color: green;font-weight: bolder;" hidden></i>-->
<!--</div>-->
<!--&lt;!&ndash; 错号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="wr" style="color: red; font-weight: bolder;" hidden>ဆ</i>-->
<!--</div>-->
<!--</div>-->


<!--<div class="layui-form-item">-->
<!--&lt;!&ndash;<label class="layui-form-label">密码</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="password" id="pwd" name="password" required lay-verify="required" placeholder="请输入密码"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->
<!--&lt;!&ndash; 对号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="pri" style="color: green;font-weight: bolder;" hidden></i>-->
<!--</div>-->
<!--&lt;!&ndash; 错号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="pwr" style="color: red; font-weight: bolder;" hidden>ဆ</i>-->
<!--</div>-->
<!--</div>-->
<!--<div class="layui-form-item">-->
<!--&lt;!&ndash;<label class="layui-form-label">确认密码</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="password" id="rpwd" name="password1" required lay-verify="required" placeholder="请输入密码"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->
<!--&lt;!&ndash; 对号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="rpri" style="color: green;font-weight: bolder;" hidden></i>-->
<!--</div>-->
<!--&lt;!&ndash; 错号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="rpwr" style="color: red; font-weight: bolder;" hidden>ဆ</i>-->
<!--</div>-->
<!--</div>-->
<!--<div class="layui-form-item">-->
<!--&lt;!&ndash;<label class="layui-form-label">真实姓名</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="text" name="realName" id="realName" required lay-verify="required" placeholder="请输入真实姓名"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->

<!--&lt;!&ndash; 对号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="rrpri" style="color: green;font-weight: bolder;" hidden></i>-->
<!--</div>-->
<!--&lt;!&ndash; 错号 &ndash;&gt;-->
<!--<div class="layui-inline">-->
<!--<i class="layui-icon" id="rrpwr" style="color: red; font-weight: bolder;" hidden>ဆ</i>-->
<!--</div>-->
<!--</div>-->

<!--<div class="layui-form-item">-->
<!--&lt;!&ndash;<label class="layui-form-label">学号</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="text" name="stuId" required lay-verify="number" placeholder="请输入学号"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->
<!--</div>-->
<!--<div class="layui-form-item ">-->
<!--&lt;!&ndash;<label class="layui-form-label">手机号</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="text" name="phone" required lay-verify="phone" placeholder="请输入手机号"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->
<!--</div>-->
<!--<div class="layui-form-item ">-->
<!--&lt;!&ndash;<label class="layui-form-label">班级</label>&ndash;&gt;-->
<!--<div class="layui-input-inline">-->
<!--<input type="text" name="className" required lay-verify="required" placeholder="请输入班级"-->
<!--autocomplete="off" class="layui-input">-->
<!--</div>-->
<!--</div>-->


<!--<div class="layui-form-item">-->
<!--<div class="layui-input-block">-->
<!--<button class="layui-btn" lay-submit="" lay-filter="demo1">立即提交</button>-->
<!--<button type="reset" class="layui-btn layui-btn-primary">重置</button>-->
<!--</div>-->

<!--</div>-->


<!--</form>-->


<!--</div>-->
<div class="wrap login_wrap">
    <div class="content">

        <div class="logo"></div>

        <div class="login_box">

            <div class="login_form">
                <div class="login_title">
                    注册
                </div>
                <form id="form1" th:action="@{/registered1}" method="post" >

                    <div class="form_text_ipt">
                        <input id="userName" name="username" type="text" placeholder="用户名">
                    </div>
                    <div class="ececk_warning"><span id="msg"></span></div>


                    <div class="form_text_ipt">
                        <input id="pwd" name="password" type="password" placeholder="密码">
                    </div>
                    <div class="ececk_warning"><span id="msg2"></span></div>


                    <div class="form_text_ipt">
                        <input id="rpwd" name="password1" type="password" placeholder="重复密码">
                    </div>
                    <div class="ececk_warning"><span id="msg3"></span></div>


                    <div class="form_text_ipt">
                        <input id="realName" name="realName" type="text" placeholder="真实姓名">
                    </div>
                    <div class="ececk_warning"><span id="msg4"></span></div>


                    <div class="form_text_ipt">
                        <input name="stuId" type="text" placeholder="学号">
                    </div>
                    <div class="ececk_warning"><span id="msg5"></span></div>



                </form>

                <div class="form_btn">
                    <button  type="button"   id="zhuce">注册</button>
                </div>
                <div class="form_reg_btn">
                    <span>已有帐号？</span><a th:href="@{/login}">马上登录</a>
                </div>

                <div class="other_login">
                    <div class="left other_left">
                        <span>其它登录方式</span>
                    </div>
                    <div class="right other_right">
                        <a href="#"><i class="fa fa-qq fa-2x"></i></a>
                        <a href="#"><i class="fa fa-weixin fa-2x"></i></a>
                        <a href="#"><i class="fa fa-weibo fa-2x"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" th:src="@{../registered/js/jquery.min.js}"></script>
<script type="text/javascript" th:action="@{../layui/jquery-3.3.1.min.js}"></script>
<script type="text/javascript" th:src="@{../registered/js/common.js}"></script>
<div style="text-align:center;">
</div>


<script type="text/javascript">
    $(document).ready(function () {
        /**
         * 用户名校验
         */
        $("#userName").blur(function () {
            var username = {username: $("#userName").val()};
            var reg = /^[a-zA-Z]{1}([a-zA-Z0-9]|[._]){4,19}$/;
            $.ajax(
                {
                    url: '/search_name',
                    data: username,
                    async: true,
                    type: "GET",
                    dataType: "json",
                    success: function (result) {
                        if (result.code == 2) {

                            document.getElementById("msg").innerHTML = "<font color='red'>" + "用户名已存在" + "</font>"

                        } else if (result.code == 1 && $("#userName").val().match(reg)) {
                            document.getElementById("msg").innerHTML = "<font color='green'>" + "✔" + "</font>"

                        } else if (!$("#userName").val().match(reg)) {

                            document.getElementById("msg").innerHTML = "<font color='red'>" + "只能输入5-20个以字母开头、可带数字、“_”、“.”" + "</font>"
                        }
                    }

                });
        });


        <!--为密码添加正则验证-->
        $('#pwd').blur(function () {
            var reg = /^[\S]{6,12}$/;
            if (!($('#pwd').val().match(reg))) {
                document.getElementById("msg2").innerHTML = "<font color='red'>" + "密码必须6到12位，且不能出现空格" + "</font>"
            } else {
                document.getElementById("msg2").innerHTML = "<font color='green'>" + "✔" + "</font>"
            }

            return false;
        });


        <!--验证两次密码是否一致-->
        $('#rpwd').blur(function () {
            if ($('#pwd').val() != $('#rpwd').val()) {
                document.getElementById("msg3").innerHTML = "<font color='red'>" + "两次密码输入不相同" + "</font>"
            } else {
                document.getElementById("msg3").innerHTML = "<font color='green'>" + "✔" + "</font>"
            }
            ;
        });


        <!--姓名正则表达式-->

        $('#realName').blur(function () {
            var reg = /^[\u4E00-\u9FA5A-Za-z]+$/;
            if (!($('#realName').val().match(reg))) {
                document.getElementById("msg4").innerHTML = "<font color='red'>" + "请输入中文或英文" + "</font>"

            } else {
                document.getElementById("msg4").innerHTML = "<font color='green'>" + "✔" + "</font>"
            }

            return false;
        });

        $("#zhuce").on('click',function(){
            var headers = {};
            headers['X-CSRF-TOKEN'] = "[[${_csrf.token}]]";
            $.ajax({
                //几个参数需要注意一下
                type: "POST",//方法类型
                async: true,
                headers:headers,
                url: "/registered1",//url
                dataType: "json",
                data: $("#form1").serialize(),
                success: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)
                    if (result.code == 2) {
                        setTimeout(function () {
                            window.parent.location.href = "/index";
                        }, 1000);
                        alert("注册成功");
                    } else if (result.code == 3) {
                        alert("输入数据格式错误");
                        setTimeout(function () {
                            window.parent.location.href = "/toregistered";
                        }, 1000);


                    }
                    else if (result.code == 4) {
                        setTimeout(function () {
                            window.parent.location.href = "/toregistered";
                        }, 1000);
                        alert("输入用户名错误");

                    }else if (result.code == 0) {
                        setTimeout(function () {
                            window.parent.location.href = "/toregistered";
                        }, 1000);
                        alert("用户名已存在");

                    }

                },
                error: function (result) {
                    alert.log(result);//打印服务端返回的数据(调试用)
                }

            });
            return  false;

        });





    });
    // function registered() {
    //     var headers = {};
    //     headers['X-CSRF-TOKEN'] = "[[${_csrf.token}]]";
    //     $.ajax({
    //         //几个参数需要注意一下
    //         url: "/registered1",//url
    //         data: $("#form1").serializeObject(),
    //         type: "POST",//方法类型
    //         async: false,
    //         dataType: 'text',//预期服务器返回的数据类型
    //         headers: headers,
    //         success: function (result) {
    //             console.log(result);//打印服务端返回的数据(调试用)
    //             if (result.code == 2) {
    //                 setTimeout(function () {
    //                     window.parent.location.href = "/index";
    //                 }, 1000);
    //                 alert("注册成功");
    //             } else if (result.code == 3) {
    //                 alert("输入数据格式错误");
    //
    //             } else if (result.code == 0) {
    //                 setTimeout(function () {
    //                     window.parent.location.href = "/index";
    //                 }, 1000);
    //                 alert("用户名已存在");
    //
    //             }
    //         },
    //         error: function (data) {
    //             if (data.code == 0) {
    //                 setTimeout(function () {
    //                     window.parent.location.href = "/index";
    //                 }, 1000);
    //                 alert("用户名已存在");
    //
    //             }
    //         }
    //
    //     });
    //
    //     return false;
    // }

</script>

<!--<script type="text/javascript" src="../layui/layui.js"></script>-->
<!--<script>-->
<!--//JavaScript代码区域-->
<!--layui.use(['element', 'jquery', 'form', 'laydate'], function () {-->
<!--var element = layui.element,-->
<!--$ = layui.jquery-->
<!--, form = layui.form-->
<!--laydate = layui.laydate;-->
<!--$('#username').blur(function () {-->
<!--var username = $(this).val();-->
<!--var reg = /^[a-zA-Z]{1}([a-zA-Z0-9]|[._]){4,19}$/;-->

<!--//alert(user);-->
<!--$.ajax({-->
<!--url: '/search_name',-->
<!--type: 'GET',-->
<!--dataType: 'json',-->
<!--data: {username: username},-->
<!--//验证用户名是否可用-->
<!--success: function (data) {-->
<!--if (data.code == 1 && ($('#username').val().match(reg))) {-->
<!--$('#ri').removeAttr('hidden');-->
<!--$('#wr').attr('hidden', 'hidden');-->

<!--} else {-->
<!--$('#wr').removeAttr('hidden');-->
<!--$('#ri').attr('hidden', 'hidden');-->
<!--layer.msg('当前用户名已被占用! ');-->
<!--if (!($('#username').val().match(reg))) {-->

<!--layer.msg('只能输入5-20个以字母开头、可带数字、“_”、“.”的字串 ');-->
<!--}-->


<!--}-->
<!--}-->
<!--})-->
<!--return false-->

<!--});-->

<!--// 为密码添加正则验证-->
<!--$('#pwd').blur(function () {-->
<!--var reg = /^[\S]{6,12}$/;-->
<!--if (!($('#pwd').val().match(reg))) {-->
<!--//layer.msg('请输入合法密码');-->
<!--$('#pwr').removeAttr('hidden');-->
<!--$('#pri').attr('hidden', 'hidden');-->
<!--layer.msg('密码必须6到12位，且不能出现空格');-->
<!--} else {-->
<!--$('#pri').removeAttr('hidden');-->
<!--$('#pwr').attr('hidden', 'hidden');-->
<!--}-->

<!--return false;-->
<!--});-->


<!--//验证两次密码是否一致-->
<!--$('#rpwd').blur(function () {-->
<!--if ($('#pwd').val() != $('#rpwd').val()) {-->
<!--$('#rpwr').removeAttr('hidden');-->
<!--$('#rpri').attr('hidden', 'hidden');-->
<!--layer.msg('两次输入密码不一致!');-->
<!--} else {-->
<!--$('#rpri').removeAttr('hidden');-->
<!--$('#rpwr').attr('hidden', 'hidden');-->
<!--}-->
<!--;-->
<!--});-->

<!--//姓名正则表达式-->

<!--$('#realName').blur(function () {-->
<!--var reg = /^[\u4E00-\u9FA5A-Za-z]+$/;-->
<!--if (!($('#realName').val().match(reg))) {-->

<!--$('#rrpwr').removeAttr('hidden');-->
<!--$('#rrpri').attr('hidden', 'hidden');-->
<!--layer.msg('请输入中文或英文');-->
<!--} else {-->
<!--$('#rrpri').removeAttr('hidden');-->
<!--$('#rrpwr').attr('hidden', 'hidden');-->
<!--}-->

<!--return false;-->
<!--});-->


<!--//from表单提交 监听事件-->
<!--form.on('submit(demo1)', function (data) {-->
<!--var headers = {};-->
<!--headers['X-CSRF-TOKEN'] = "[[${_csrf.token}]]";-->
<!--$.ajax({-->
<!--url: '/registered1',-->
<!--type: 'POST',-->
<!--dataType: 'json',-->
<!--headers: headers,-->
<!--data: {-->
<!--username: data.field.username,-->
<!--password: data.field.password,-->
<!--password1: data.field.password1,-->
<!--stuId: data.field.stuId,-->
<!--realName: data.field.realName,-->
<!--phone: data.field.phone,-->
<!--className: data.field.className-->
<!--},-->
<!--success: function (data) {-->
<!--if (data.code == 200) {-->
<!--layer.closeAll('loading');-->
<!--layer.load(2);-->
<!--layer.msg("注册成功过", {icon: 6});-->
<!--setTimeout(function () {-->
<!--window.parent.location.href = "/index";-->
<!--}, 1000);-->
<!--//加载层-风格-->
<!--}-->
<!--else if (data.code == 3) {-->
<!--layer.msg("数据格式错误", {icon: 5});-->
<!--} else if (data.code == 2) {-->
<!--layer.msg("用户名已经存在", {icon: 5});-->
<!--}-->
<!--}-->
<!--})-->
<!--return false;-->
<!--});-->


<!--});-->


<!--</script>-->


</body>
</html>